RewriteEngine On

RewriteRule ^api/posts/([0-9]+)/([a-z0-9-]+)(/?)([0-9]*)$ index.php?p=$2&id=$4&mainId=$1
RewriteRule ^api/([a-z0-9-]+)(/?)([0-9]*)$ index.php?p=$1&id=$3